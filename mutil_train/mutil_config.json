{
  "training_type": "classification",
  "task_type": "classification",
  "training_dataset": "./dataset/multiclass_dataset",
  "image_dir": "./dataset/multiclass_dataset/images",
  "annotations": "./dataset/multiclass_dataset/annotations/annotations.json",
  "output_dir": "./mutil_train/output",
  "pretrained_model_path": "model.pth",
  "freeze_feature_extractor": false,
  "freeze_epochs": 5,
  "epochs": 50,
  "batch_size": 16,
    "num_workers": 4,
  "gpus_to_use": [1,2,3],
  "seed": 40,
  "num_trials": 20,
  "train_ratio": 70,
  "val_ratio": 15,
  "test_ratio": 15,
  "save_checkpoints_interval": 5,
  "max_gpu_memory_mb": 34000,
  "hidden_size_cfc_path1": 24,
  "hidden_size_cfc_path2": 24,
  "fusion_units": 10,
  "fusion_output_size": 5,
  "sparsity_level": 0.5,
  "cfc_seed": 22223,
  "output_size_cfc_path1": 5,
  "output_size_cfc_path2": 5,
  "feature_dim": 48,
  "max_seq_length": 40,
  "accumulation_steps": 1,
  "patience": 17,
  "enable_auto_hp_check": false,
  "manual_optimizer": true,
  "optimizer": "RMSprop",
  "lr":0.00039572962060422897,
  "weight_decay": 0.00022925798133642564,
  "beta1": 0.9,
  "beta2": 0.999,
  "epsilon": 9.849070329109733e-07,
  "momentum": 0.4495884994821225,
  "nesterov": false,
  "alpha": 0.9688387879192244,
  "use_multi_gpu": true,
  "log_level": "INFO",
  "loss_type": "auto",
  "image_size": 224,
  "num_classes": 5,
  "dropout_rate": 0.3,
  "frame_encoder_num_conv_layers": 4,
  "frame_encoder_base_channels": 64,
  "frame_encoder_channel_multiplier": 2,
  "frame_encoder_kernel_size": 3,
  "frame_encoder_pool_kernel_size": 2,
  "frame_encoder_pool_stride": 2,
  "path2_conv1d_kernel_size": 3,
  "fusion_mlp_hidden_dim": 64,
  "fusion_min_alpha": 0.1,
  "fusion_max_alpha": 1.0,
  "fusion_schedule": "linear",
  "use_mixed_precision": false,
  "enable_progressive": true,
  "min_alpha": 0.1,
  "max_alpha": 1.0,
  "alpha_schedule": "linear",
  "enable_auto_batch_size_adjustment": false,

  "detection": {
    "training_dataset": "./dataset/detection_dataset/",
    "output_dir": "./output_detection",
    "use_model_parallelism": true,
    "use_multi_gpu": false, 
    "device_map": {
      "main": "cuda:0",
      "global": "cuda:3",
      "modulation": "cuda:1",
      "local_cnn": "cuda:1",
      "fpn": "cuda:2",
      "fuser": "cuda:3",
      "head": "cuda:3"
    },
    "seed": 42,
    "log_level": "INFO",

    "max_seq_length": 40,
    "use_mixed_memory":true,
    "max_gpu_memory_mb": null, 

    "mixed_precision": true, 
    "train_ratio": 70,
    "val_ratio": 20,
    "test_ratio": 10,

    "feature_dim": 64, 
    "temporal_feature_size": 64, 
    "sequence_length": 40, 
    "global_downsample_size": 1024,
    "global_cnn_layers": 2, 
    "global_cnn_base_channels": 16,
    "global_cnn_feature_dim": 32, 
    "global_cfc_hidden_size": 64, 
    "global_cfc_output_size": 16, 
    "global_cfc_sparsity": 0.5, 
    "global_cfc_seed": 22223, 
    "image_size": 4000, 

    "tile_size": 512, 
    "overlap_ratio": 0.25,
    "use_checkpoint": false, 
    "fcos_num_convs": 4, 
    "use_gn": true, 
    "center_sampling": true, 
    "center_sample_radius": 1.5, 
    "local_cnn_layers": 4,
    "local_cnn_base_channels": 32,
    "strides": [8, 16, 32, 64, 128],
    "regress_ranges": [ 
      [0, 64], [64, 128], [128, 256], [256, 512], [512, 100000000.0]
    ],
    "fpn_out_channels": 64, 
    "use_fpn_extra_level": true,

    "epochs": 100,
    "batch_size": 2, 
    "enable_auto_batch_size_adjustment":false, 
    "accumulation_steps": 4, 

    "optimizer": "AdamW", 
    "learning_rate": 0.0008, 
    "weight_decay": 0.0001, 
    "beta1": 0.9, 
    "beta2": 0.999,
    "epsilon": 1e-08, 
    "amsgrad": false, 
    "momentum": 0.9, 
    "nesterov": false,
    

    "learning_rate_schedule": "cosine",
    "warmup_epochs": 5, 
    "min_lr": 1e-06,
    "step_size": 30, 
    "gamma": 0.1, 
    "plateau_factor": 0.5,
    "plateau_patience": 10, 

    "patience": 20,
    "early_stopping_min_delta": 0.0001, 

    "freeze_backbone": false, 
    "freeze_epochs": 10, 
    "freeze_exclude_paths": [], 

    "save_checkpoints_interval": 10, 
    "enable_tensorboard": true,

    "nms_iou_threshold": 0.5, 
    "score_threshold": 0.05, 
    "max_detections": 500, 
    "use_soft_nms": true, 
    "soft_nms_sigma": 0.5, 
    "map_iou_thresholds": [0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95], 

    "enable_auto_hp_check": true,
    "hp_optimization": {
	      "study_name": "focust_detection_hpo",
      "num_trials": 5,
      "timeout": null,
      "n_jobs": 1,
      "hpo_startup_trials": 1,
      "hpo_warmup_steps": 1,
      "optimize_classes": [
        "default"
      ]
    },
    "use_difference_input": false, 
    "difference_interval": 1, 
    "use_attention_input": false, 
    "attention_map_config": { 
        "method": "gaussian", 
        "sigma_scale": 0.15, 
        "focus_on_small": false, 
        "small_threshold": 10000000
    },
    "fcos_prior": 0.01, 
    "fcos_use_scale": true,
    "iou_loss_eps": 1e-06, 
    "use_focal_loss": true,
    "focal_loss_alpha": 0.25, 
    "focal_loss_gamma": 2.0,
    "dropout_rate": 0.2, 
    "num_groups_norm": 32, 
    "classification_model_path": null, 
    "fcos_exp_max_val": 7.0 
},
  "data_mode": "normal",
  "language": "en"
}
